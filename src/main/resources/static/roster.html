<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Salvo App</title>
</head>
<body>
    <h1>Player Roster</h1>
    <div>
        <label for="newplayer">New Player&#58;
            <input type="text" name="newplayer" id="newplayer" placeholder="lala@lala.com">
        </label>
        <button type="button" onclick="addPerson('meric@gmail.com')">Add</button>
    </div>
    <ul id='playerList'></ul>
    <script type='module'>
        const fetchJson = url =>
            fetch(url).then((response) => {
                if(response.ok){
                    return response.json();
                } else {
                    throw new Error('dfgdfgdf' + response.statusText);
                }
            });

        fetchJson('http://localhost:8080/api/player').then(json => {
            json.forEach(player => {
                const listItem = document.createElement('li');
                const listItemText = document.createTextNode(player['username'])
                listItem.appendChild(listItemText);
                document.getElementById('playerList').appendChild(listItem);
            })
        }).catch(error => {
            console.log('error', error);
        });

        const addPerson = username =>
            fetch('http://localhost:8080/api/player', {
                method: 'POST',
                body: JSON.stringify({username})
            }).then((response) => {
                if(response.ok){
                    alert( 'Appointment saved' );
                } else {
                    throw new Error('add person error ' + response.statusText);
                }
            });
    </script>
</body>
</html>